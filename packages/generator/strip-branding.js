#!/usr/bin/env node
'use strict';

const fs = require('fs');
const path = require('path');

const outputDir = path.join(__dirname, 'output');

for (const file of fs.readdirSync(outputDir)) {
  const ext = path.extname(file);
  if (!['.html', '.md'].includes(ext)) continue;

  const filePath = path.join(outputDir, file);
  let content = fs.readFileSync(filePath, 'utf8');
  const before = content.length;

  // Remove "Generated by yamlresume" lines and surrounding whitespace
  content = content.replace(/.*[Gg]enerated\s+(by|with)\s+yamlresume.*/gi, '');
  // Remove empty trailing lines left behind
  content = content.replace(/\n{3,}/g, '\n\n').trimEnd() + '\n';

  if (content.length !== before) {
    fs.writeFileSync(filePath, content);
    console.log(`Stripped branding from ${file}`);
  }
}
